# 庫存查詢系統專案需求分析

## 專案現狀概述

您的專案已具備基礎的庫存查詢系統架構，包括：
- ✅ 完整的後端 API 和資料模型 (`src/types/inquiry.ts`, `src/services/inquiryService.ts`)
- ✅ 管理員庫存查詢管理界面 (`src/app/admin/inquiries/page.tsx`)
- ✅ 購物車庫存查詢提交功能 (`src/app/cart/page.tsx`)
- ✅ 基礎的 Email 服務架構 (`src/lib/email-service.ts`)

## 新完成功能

**最新更新 (2025-08-23):** 已完成階段一使用者介面功能及系統文案更新

- ✅ **使用者庫存查詢列表頁面** (`src/app/inquiry/page.tsx`)
  - 完整的查詢單列表顯示
  - 狀態篩選（全部、待確認、有庫存、已預訂、已完成、已取消）
  - 搜尋功能（支援查詢單號、商品名稱）
  - 分頁功能與響應式設計

- ✅ **庫存查詢詳情頁面** (`src/app/inquiry/[id]/page.tsx`)
  - 完整查詢資訊與商品清單顯示
  - 狀態說明與操作按鈕
  - 確認預訂功能（含確認 Modal）
  - 重新查詢功能（複製到購物車）
  - PDF 下載功能（專業佈局、中文支援）

- ✅ **輔助組件開發**
  - `src/components/inquiry/InquiryStatusBadge.tsx` - 狀態標籤組件
  - `src/components/inquiry/InquiryCard.tsx` - 可重用查詢單卡片
  - `src/components/inquiry/InquiryPDFDocument.tsx` - PDF 文件模板
  - `src/components/inquiry/PDFStyles.ts` - PDF 樣式定義

- ✅ **系統整合**
  - 使用者導航選單整合（AuthButton 下拉選單）
  - 購物車頁面支援重新查詢資料導入
  - 完整的認證與權限檢查
  - PDF 生成套件整合（@react-pdf/renderer）

- ✅ **系統文案更新**
  - 所有使用者界面文字從「詢價」更新為「庫存查詢」
  - 管理員界面與狀態標籤的文字更新
  - 系統狀態標籤：「待處理」→「待確認」、「已報價」→「有庫存」、「已確認」→「已預訂」
  - 所有文案和狀態說明更新為庫存查詢與預訂情境

## 缺失功能清單

### 🔴 1. 前端使用者介面（高優先級）

#### 1.1 使用者庫存查詢管理頁面
**檔案位置:** `src/app/inquiry/page.tsx` ✅ **已完成**
- [x] 使用者查詢單列表頁面
- [x] 查詢單狀態篩選（待確認、有庫存、已預訂等）
- [x] 查詢單搜尋功能
- [x] 分頁功能

#### 1.2 庫存查詢詳情頁面
**檔案位置:** `src/app/inquiry/[id]/page.tsx` ✅ **已完成**
- [x] 詳細的查詢單資訊展示
- [x] 查詢項目清單
- [x] 狀態追蹤時間軸（狀態說明與操作）
- [x] 客戶留言/備註功能（顯示備註內容）
- [x] 下載查詢單 PDF 功能（使用 React-PDF）

#### 1.3 快速庫存查詢功能
**檔案位置:** `src/components/QuickInquiryButton.tsx`
- [ ] 產品頁面直接庫存查詢按鈕
- [ ] 快速查詢表單 Modal
- [ ] 批量產品查詢功能
- [ ] 訪客查詢功能（不需登入）

### 🔴 2. 通知系統整合（高優先級）

#### 2.1 Email 通知完整實作
**檔案位置:** `src/lib/email-templates/`
- [ ] 查詢確認信模板（客戶收到）
- [ ] 新查詢通知信（管理員收到）
- [ ] 庫存確認通知信模板
- [ ] 查詢單狀態更新通知

#### 2.2 系統通知
**檔案位置:** `src/components/NotificationCenter.tsx`
- [ ] 站內通知系統
- [ ] 通知歷史記錄
- [ ] 通知偏好設定

### 🟡 3. 管理功能增強（中優先級）

#### 3.1 查詢單管理增強
**檔案位置:** `src/app/admin/inquiries/`
- [ ] 批量操作（狀態更新、刪除）
- [ ] 查詢單匯出功能（Excel/PDF）
- [ ] 查詢單範本管理
- [ ] 自動回覆設定

#### 3.2 報價管理系統
**檔案位置:** `src/app/admin/quotes/`
- [ ] 報價單生成工具
- [ ] 報價範本管理
- [ ] 報價歷史追蹤
- [ ] 報價審核流程

#### 3.3 分析報表
**檔案位置:** `src/app/admin/reports/inquiries/`
- [ ] 查詢統計儀表板
- [ ] 轉換率分析
- [ ] 客戶查詢行為分析
- [ ] 產品查詢熱度分析

### 🟡 4. 使用者體驗優化（中優先級）

#### 4.1 查詢流程優化
**檔案位置:** `src/components/inquiry/`
- [ ] 多步驟查詢表單
- [ ] 查詢單草稿保存功能
- [ ] 常購清單轉查詢單
- [x] 查詢單複製功能（重新查詢功能）

#### 4.2 個人化功能
**檔案位置:** `src/app/profile/inquiries/`
- [ ] 個人查詢偏好設定
- [ ] 查詢單標籤系統
- [ ] 收藏查詢單功能
- [ ] 查詢提醒設定

### 🟢 5. 系統整合功能（低優先級）

#### 5.1 庫存整合
**檔案位置:** `src/lib/inventory-integration.ts`
- [ ] 即時庫存檢查
- [ ] 缺貨替代品建議
- [ ] 預估到貨時間顯示

#### 5.2 價格計算系統
**檔案位置:** `src/lib/pricing-engine.ts`
- [ ] 動態價格計算
- [ ] 批量折扣計算
- [ ] 運費自動估算
- [ ] 付款條件管理

#### 5.3 第三方整合
- [ ] 物流系統整合
- [ ] ERP 系統同步
- [ ] 會計系統整合
- [ ] CRM 系統整合

### 🟢 6. 資料安全與維護（低優先級）

#### 6.1 資料保護
**檔案位置:** `src/lib/data-protection.ts`
- [ ] 敏感資料加密
- [ ] GDPR 合規功能
- [ ] 資料匿名化工具
- [ ] 資料保留政策

#### 6.2 系統監控
**檔案位置:** `src/lib/monitoring/`
- [ ] 詢價系統健康監控
- [ ] 操作日誌記錄
- [ ] 錯誤追蹤系統
- [ ] 效能監控儀表板

## 建議實作順序

### 階段一：基礎使用者介面（1-2 週）✅ **已完成**
1. ✅ 使用者查詢單列表頁面
2. ✅ 查詢單詳情頁面  
3. ✅ 系統文案更新（從詢價轉換為庫存查詢）
4. ⏳ 快速庫存查詢按鈕功能（待實作）

### 階段二：通知系統（1 週）
1. Email 模板設計與實作
2. 通知觸發機制
3. 通知偏好設定

### 階段三：管理功能增強（2 週）
1. 批量操作功能
2. 匯出功能
3. 基礎報表功能

### 階段四：進階功能（2-3 週）
1. 報價管理系統
2. 個人化功能
3. 系統整合功能

## 技術考量

### 前端技術棧
- **Framework:** Next.js 14 (已使用)
- **UI Components:** Tailwind CSS (已使用)
- **狀態管理:** React Context API (已使用)
- **表單處理:** React Hook Form (建議新增)
- **PDF 生成:** jsPDF 或 Puppeteer

### 後端技術棧
- **Database:** Supabase (已使用)
- **Email Service:** Resend 或 SendGrid
- **File Storage:** Supabase Storage (已使用)
- **PDF 生成:** Puppeteer 或 PDFKit

### 效能優化
- [ ] 詢價單列表分頁載入
- [ ] 圖片懶加載
- [ ] API 響應快取
- [ ] 資料庫查詢優化

## 預估工作量

| 功能模組 | 預估時間 | 複雜度 |
|---------|---------|--------|
| 使用者詢價介面 | 2-3 週 | 中等 |
| 通知系統 | 1-2 週 | 中等 |
| 管理功能增強 | 2-3 週 | 中等 |
| 報價管理系統 | 2-3 週 | 高 |
| 分析報表 | 1-2 週 | 中等 |
| 系統整合 | 3-4 週 | 高 |

**總預估時間:** 11-17 週  
**已完成進度:** 階段一已完成，系統文案更新完成 (~25% 整體進度)

## 成本效益分析

### 高投資回報率功能
1. **使用者詢價介面** - 直接影響客戶體驗
2. **Email 通知系統** - 提升客戶滿意度
3. **批量管理功能** - 提升管理效率

### 中投資回報率功能
1. **報價管理系統** - 提升銷售流程效率
2. **分析報表** - 支援業務決策

### 低投資回報率功能
1. **第三方系統整合** - 需要根據實際需求評估
2. **進階個人化功能** - 使用者基數達到一定規模後考慮

## 結論

您的庫存查詢系統已有良好的基礎，並已成功從傳統的詢價系統轉換為庫存查詢與預訂系統。整體使用者体驗已大幅提升，下一步建議優先實作通知系統和進階管理功能。其他功能可依據實際業務需求和資源情況逐步實作。

**重要更新：**
- 系統定位從「詢價系統」轉換為「庫存查詢與預訂系統」
- 所有狀態標籤和文案已更新為新的業務流程
- 使用者界面和管理員界面均已更新完畢

---

**最後更新:** 2025-08-23  
**分析人員:** Claude Code Assistant  
**專案版本:** 基於 develop 分支分析